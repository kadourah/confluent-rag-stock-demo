import {NotImplementedError} from "../exceptions.dist.mjs";
import WebCryptoAes from "./webcrypto/aes.dist.mjs";
import WebCryptoAesCtr from "./webcrypto/aes_ctr.dist.mjs";
export class WebCryptoProvider {
  crypto;
  constructor(crypto = window.crypto) {
    this.crypto = crypto;
  }
  async importBlockCipherKey(keyData) {
    return WebCryptoAes.importKey(this.crypto, keyData);
  }
  async importCTRKey(keyData) {
    try {
      return await WebCryptoAesCtr.importKey(this.crypto, keyData);
    } catch (e) {
      if (e.message.includes("unsupported")) {
        throw new NotImplementedError("WebCryptoProvider: AES-CTR unsupported. Use SoftCryptoProvider.");
      } else {
        throw e;
      }
    }
  }
}
